Warning: torch.cumprod not supported on MPS, switching to CPU.
Using device: cpu
训练集样本数: 29427
Epoch 1/50 train:   0%|          | 0/115 [00:00<?, ?it/s]Epoch 1/50 train:   1%|          | 1/115 [01:59<3:47:58, 119.99s/it]Epoch 1/50 train:   2%|▏         | 2/115 [03:49<3:34:51, 114.09s/it]Epoch 1/50 train:   3%|▎         | 3/115 [05:39<3:29:14, 112.09s/it]Epoch 1/50 train:   3%|▎         | 4/115 [07:36<3:30:47, 113.94s/it]Epoch 1/50 train:   4%|▍         | 5/115 [09:31<3:29:51, 114.46s/it]Epoch 1/50 train:   5%|▌         | 6/115 [11:22<3:25:28, 113.11s/it]Epoch 1/50 train:   6%|▌         | 7/115 [13:26<3:29:57, 116.64s/it]Epoch 1/50 train:   7%|▋         | 8/115 [15:20<3:26:35, 115.84s/it]Epoch 1/50 train:   8%|▊         | 9/115 [17:15<3:24:00, 115.48s/it]Epoch 1/50 train:   9%|▊         | 10/115 [19:12<3:23:08, 116.08s/it]Epoch 1/50 train:  10%|▉         | 11/115 [21:13<3:24:01, 117.70s/it]Epoch 1/50 train:  10%|█         | 12/115 [23:13<3:23:16, 118.41s/it]Epoch 1/50 train:  11%|█▏        | 13/115 [25:03<3:16:46, 115.75s/it]Epoch 1/50 train:  12%|█▏        | 14/115 [26:59<3:15:01, 115.86s/it]Epoch 1/50 train:  13%|█▎        | 15/115 [28:54<3:12:49, 115.69s/it]Epoch 1/50 train:  14%|█▍        | 16/115 [30:47<3:09:22, 114.77s/it]Epoch 1/50 train:  15%|█▍        | 17/115 [32:43<3:08:00, 115.11s/it]Epoch 1/50 train:  16%|█▌        | 18/115 [34:37<3:05:47, 114.92s/it]Epoch 1/50 train:  17%|█▋        | 19/115 [36:36<3:05:29, 115.93s/it]Epoch 1/50 train:  17%|█▋        | 20/115 [38:29<3:02:12, 115.08s/it]Epoch 1/50 train:  18%|█▊        | 21/115 [40:16<2:56:37, 112.74s/it]Epoch 1/50 train:  19%|█▉        | 22/115 [42:16<2:58:00, 114.84s/it]Epoch 1/50 train:  20%|██        | 23/115 [44:12<2:56:44, 115.27s/it]Epoch 1/50 train:  21%|██        | 24/115 [46:04<2:53:20, 114.30s/it]Epoch 1/50 train:  22%|██▏       | 25/115 [48:02<2:53:09, 115.43s/it]Epoch 1/50 train:  23%|██▎       | 26/115 [50:01<2:52:48, 116.50s/it]Epoch 1/50 train:  23%|██▎       | 27/115 [52:00<2:52:03, 117.31s/it]Epoch 1/50 train:  24%|██▍       | 28/115 [54:01<2:51:32, 118.31s/it]Epoch 1/50 train:  25%|██▌       | 29/115 [55:53<2:46:55, 116.47s/it]Epoch 1/50 train:  26%|██▌       | 30/115 [57:55<2:47:15, 118.06s/it]Epoch 1/50 train:  27%|██▋       | 31/115 [59:53<2:45:14, 118.03s/it]Epoch 1/50 train:  28%|██▊       | 32/115 [1:01:56<2:45:11, 119.41s/it]Epoch 1/50 train:  29%|██▊       | 33/115 [1:03:54<2:42:58, 119.26s/it]Epoch 1/50 train:  30%|██▉       | 34/115 [1:05:47<2:38:14, 117.22s/it]Epoch 1/50 train:  30%|███       | 35/115 [1:07:49<2:38:24, 118.81s/it]Epoch 1/50 train:  31%|███▏      | 36/115 [1:09:42<2:34:06, 117.05s/it]Epoch 1/50 train:  32%|███▏      | 37/115 [1:11:42<2:33:08, 117.80s/it]Epoch 1/50 train:  33%|███▎      | 38/115 [1:13:40<2:31:13, 117.83s/it]Epoch 1/50 train:  34%|███▍      | 39/115 [1:15:32<2:26:56, 116.01s/it]Epoch 1/50 train:  35%|███▍      | 40/115 [1:17:22<2:23:01, 114.42s/it]Epoch 1/50 train:  36%|███▌      | 41/115 [1:19:15<2:20:36, 114.00s/it]Epoch 1/50 train:  37%|███▋      | 42/115 [1:21:10<2:18:54, 114.17s/it]Epoch 1/50 train:  37%|███▋      | 43/115 [1:23:04<2:16:59, 114.16s/it]Epoch 1/50 train:  38%|███▊      | 44/115 [1:24:54<2:13:38, 112.94s/it]Epoch 1/50 train:  39%|███▉      | 45/115 [1:26:50<2:12:36, 113.67s/it]Epoch 1/50 train:  40%|████      | 46/115 [1:28:50<2:12:55, 115.58s/it]Epoch 1/50 train:  41%|████      | 47/115 [1:30:42<2:09:59, 114.70s/it]Epoch 1/50 train:  42%|████▏     | 48/115 [1:32:39<2:08:41, 115.25s/it]Epoch 1/50 train:  43%|████▎     | 49/115 [1:34:33<2:06:18, 114.83s/it]Epoch 1/50 train:  43%|████▎     | 50/115 [1:36:30<2:05:17, 115.65s/it]Epoch 1/50 train:  44%|████▍     | 51/115 [1:38:29<2:04:25, 116.65s/it]Epoch 1/50 train:  45%|████▌     | 52/115 [1:40:31<2:04:05, 118.18s/it]Epoch 1/50 train:  46%|████▌     | 53/115 [1:42:34<2:03:30, 119.52s/it]Epoch 1/50 train:  47%|████▋     | 54/115 [1:44:24<1:58:53, 116.95s/it]Epoch 1/50 train:  48%|████▊     | 55/115 [1:46:20<1:56:32, 116.54s/it]Epoch 1/50 train:  49%|████▊     | 56/115 [1:48:19<1:55:21, 117.31s/it]Epoch 1/50 train:  50%|████▉     | 57/115 [1:50:14<1:52:44, 116.63s/it]Epoch 1/50 train:  50%|█████     | 58/115 [1:52:06<1:49:32, 115.31s/it]Epoch 1/50 train:  51%|█████▏    | 59/115 [1:54:04<1:48:10, 115.90s/it]Epoch 1/50 train:  52%|█████▏    | 60/115 [1:56:10<1:49:02, 118.96s/it]Epoch 1/50 train:  53%|█████▎    | 61/115 [1:58:03<1:45:29, 117.21s/it]Epoch 1/50 train:  54%|█████▍    | 62/115 [1:59:57<1:42:45, 116.33s/it]Epoch 1/50 train:  55%|█████▍    | 63/115 [2:01:47<1:39:12, 114.47s/it]Epoch 1/50 train:  56%|█████▌    | 64/115 [2:03:38<1:36:19, 113.32s/it]Epoch 1/50 train:  57%|█████▋    | 65/115 [2:05:31<1:34:15, 113.11s/it]Epoch 1/50 train:  57%|█████▋    | 66/115 [2:07:28<1:33:18, 114.25s/it]Epoch 1/50 train:  58%|█████▊    | 67/115 [2:09:20<1:31:03, 113.83s/it]Epoch 1/50 train:  59%|█████▉    | 68/115 [2:11:20<1:30:25, 115.45s/it]Epoch 1/50 train:  60%|██████    | 69/115 [2:13:15<1:28:30, 115.44s/it]Epoch 1/50 train:  61%|██████    | 70/115 [2:15:15<1:27:31, 116.70s/it]Epoch 1/50 train:  62%|██████▏   | 71/115 [2:17:17<1:26:47, 118.34s/it]Epoch 1/50 train:  63%|██████▎   | 72/115 [2:19:23<1:26:25, 120.60s/it]Epoch 1/50 train:  63%|██████▎   | 73/115 [2:21:19<1:23:25, 119.19s/it]Epoch 1/50 train:  64%|██████▍   | 74/115 [2:23:14<1:20:44, 118.15s/it]Epoch 1/50 train:  65%|██████▌   | 75/115 [2:25:17<1:19:39, 119.50s/it]Epoch 1/50 train:  66%|██████▌   | 76/115 [2:27:11<1:16:39, 117.93s/it]Epoch 1/50 train:  67%|██████▋   | 77/115 [2:29:10<1:14:45, 118.04s/it]Epoch 1/50 train:  68%|██████▊   | 78/115 [2:31:07<1:12:44, 117.97s/it]Epoch 1/50 train:  69%|██████▊   | 79/115 [2:33:01<1:09:56, 116.56s/it]Epoch 1/50 train:  70%|██████▉   | 80/115 [2:34:56<1:07:50, 116.29s/it]Epoch 1/50 train:  70%|███████   | 81/115 [2:36:45<1:04:39, 114.09s/it]Epoch 1/50 train:  71%|███████▏  | 82/115 [2:38:39<1:02:39, 113.93s/it]Epoch 1/50 train:  72%|███████▏  | 83/115 [2:40:27<59:54, 112.33s/it]  Epoch 1/50 train:  73%|███████▎  | 84/115 [2:42:27<59:06, 114.39s/it]Epoch 1/50 train:  74%|███████▍  | 85/115 [2:44:20<57:00, 114.03s/it]Epoch 1/50 train:  75%|███████▍  | 86/115 [2:46:19<55:52, 115.61s/it]Epoch 1/50 train:  76%|███████▌  | 87/115 [2:48:19<54:36, 117.02s/it]Epoch 1/50 train:  77%|███████▋  | 88/115 [2:50:16<52:36, 116.90s/it]Epoch 1/50 train:  77%|███████▋  | 89/115 [2:52:19<51:26, 118.70s/it]Epoch 1/50 train:  78%|███████▊  | 90/115 [2:54:21<49:52, 119.72s/it]Epoch 1/50 train:  79%|███████▉  | 91/115 [2:56:15<47:13, 118.06s/it]Epoch 1/50 train:  80%|████████  | 92/115 [2:58:13<45:11, 117.89s/it]Epoch 1/50 train:  81%|████████  | 93/115 [3:00:03<42:26, 115.74s/it]Epoch 1/50 train:  82%|████████▏ | 94/115 [3:01:57<40:14, 114.95s/it]Epoch 1/50 train:  83%|████████▎ | 95/115 [3:04:00<39:07, 117.39s/it]Epoch 1/50 train:  83%|████████▎ | 96/115 [3:05:58<37:18, 117.84s/it]Epoch 1/50 train:  84%|████████▍ | 97/115 [3:07:53<35:02, 116.83s/it]Epoch 1/50 train:  85%|████████▌ | 98/115 [3:09:51<33:10, 117.08s/it]Epoch 1/50 train:  86%|████████▌ | 99/115 [3:11:45<31:01, 116.37s/it]Epoch 1/50 train:  87%|████████▋ | 100/115 [3:13:37<28:44, 114.94s/it]Epoch 1/50 train:  88%|████████▊ | 101/115 [3:15:32<26:50, 115.01s/it]Epoch 1/50 train:  89%|████████▊ | 102/115 [3:17:29<25:04, 115.69s/it]Epoch 1/50 train:  90%|████████▉ | 103/115 [3:19:27<23:16, 116.36s/it]Epoch 1/50 train:  90%|█████████ | 104/115 [3:21:17<20:57, 114.32s/it]Epoch 1/50 train:  91%|█████████▏| 105/115 [3:23:11<19:03, 114.35s/it]Epoch 1/50 train:  92%|█████████▏| 106/115 [3:25:04<17:06, 114.00s/it]Epoch 1/50 train:  93%|█████████▎| 107/115 [3:27:00<15:14, 114.34s/it]Epoch 1/50 train:  94%|█████████▍| 108/115 [3:28:56<13:25, 115.05s/it]Epoch 1/50 train:  95%|█████████▍| 109/115 [3:30:50<11:28, 114.67s/it]Epoch 1/50 train:  96%|█████████▌| 110/115 [3:32:42<09:29, 113.85s/it]Epoch 1/50 train:  97%|█████████▋| 111/115 [3:34:37<07:36, 114.10s/it]Epoch 1/50 train:  97%|█████████▋| 112/115 [3:36:32<05:43, 114.42s/it]Epoch 1/50 train:  98%|█████████▊| 113/115 [3:38:36<03:54, 117.19s/it]Epoch 1/50 train:  99%|█████████▉| 114/115 [3:40:32<01:56, 116.89s/it]Epoch 1/50 train: 100%|██████████| 115/115 [3:42:33<00:00, 118.20s/it]Epoch 1/50 train: 100%|██████████| 115/115 [3:42:33<00:00, 116.12s/it]
Epoch 1/50 val:   0%|          | 0/13 [00:00<?, ?it/s]Epoch 1/50 val:   8%|▊         | 1/13 [02:01<24:22, 121.90s/it]Epoch 1/50 val:  15%|█▌        | 2/13 [04:11<23:13, 126.67s/it]Epoch 1/50 val:  23%|██▎       | 3/13 [06:08<20:20, 122.09s/it]Epoch 1/50 val:  31%|███       | 4/13 [08:05<18:00, 120.08s/it]Epoch 1/50 val:  38%|███▊      | 5/13 [09:57<15:38, 117.32s/it]Epoch 1/50 val:  46%|████▌     | 6/13 [11:56<13:42, 117.57s/it]Epoch 1/50 val:  54%|█████▍    | 7/13 [13:48<11:34, 115.79s/it]Epoch 1/50 val:  62%|██████▏   | 8/13 [15:46<09:42, 116.55s/it]Epoch 1/50 val:  69%|██████▉   | 9/13 [17:44<07:48, 117.19s/it]Epoch 1/50 val:  77%|███████▋  | 10/13 [19:40<05:49, 116.65s/it]Epoch 1/50 val:  85%|████████▍ | 11/13 [21:44<03:58, 119.05s/it]Epoch 1/50 val:  92%|█████████▏| 12/13 [23:40<01:58, 118.12s/it]Epoch 1/50 val: 100%|██████████| 13/13 [25:03<00:00, 107.38s/it]Epoch 1/50 val: 100%|██████████| 13/13 [25:03<00:00, 115.65s/it]
[SeqAR-Diffusion-Lazy] Epoch 1/50 Train Loss: 1.0391 | Val Loss: 0.7877
Saved new best SeqAR-Diffusion model at epoch 1 with val loss 0.7877
Epoch 2/50 train:   0%|          | 0/115 [00:00<?, ?it/s]Epoch 2/50 train:   1%|          | 1/115 [01:58<3:44:52, 118.35s/it]Epoch 2/50 train:   2%|▏         | 2/115 [03:57<3:43:42, 118.78s/it]Epoch 2/50 train:   3%|▎         | 3/115 [05:51<3:37:31, 116.53s/it]Epoch 2/50 train:   3%|▎         | 4/115 [07:47<3:35:13, 116.34s/it]Epoch 2/50 train:   4%|▍         | 5/115 [09:45<3:34:12, 116.84s/it]Epoch 2/50 train:   5%|▌         | 6/115 [11:35<3:28:09, 114.58s/it]Epoch 2/50 train:   6%|▌         | 7/115 [13:40<3:32:24, 118.00s/it]Epoch 2/50 train:   7%|▋         | 8/115 [15:35<3:29:05, 117.25s/it]Epoch 2/50 train:   8%|▊         | 9/115 [17:27<3:23:47, 115.35s/it]Epoch 2/50 train:   9%|▊         | 10/115 [19:22<3:21:45, 115.29s/it]