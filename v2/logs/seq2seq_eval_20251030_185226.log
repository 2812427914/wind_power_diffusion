/root/wind_power_diffusion/v2/src/utils.py:76: UserWarning: Could not infer format, so each element will be parsed individually, falling back to `dateutil`. To ensure parsing is consistent and as-expected, please specify a format.
  df[time_col] = pd.to_datetime(df[time_col], errors="coerce")
Run args: {'data': 'v2/results/cleaned.csv', 'id_col': None, 'time_col': None, 'wind_col': None, 'power_col': None, 'hist_len': 24, 'pred_len': 24, 'stride': 1, 'checkpoint': 'v2/results/checkpoints/seq2seq/best.pth', 'splits_path': 'v2/results/splits_seq2seq.json', 'batch_size': None, 'seed': 42, 'out': 'v2/results/metrics_seq2seq.json'}
[INFO] Using device: cuda
[INFO] Loaded checkpoint: v2/results/checkpoints/seq2seq/best.pth
[INFO] Using cleaned CSV snapshot: v2/results/cleaned_snapshot_2234599aa02e3f340edf4bb0b7ed3062.csv
[INFO] Loaded splits: train=47900, val=5988, test=6059

Val samples (show 5):
  [0] TurbID=1, start_idx=3666, hist=(2025-10-30 19:00:00~2025-10-30 19:00:00), pred=(2025-10-30 19:00:00~2025-10-30 20:00:00)
  [1] TurbID=1, start_idx=46, hist=(2025-10-30 00:00:00~2025-10-30 00:00:00), pred=(2025-10-30 00:00:00~2025-10-30 00:00:00)
  [2] TurbID=1, start_idx=2727, hist=(2025-10-30 15:00:00~2025-10-30 15:00:00), pred=(2025-10-30 15:00:00~2025-10-30 15:00:00)
  [3] TurbID=1, start_idx=2705, hist=(2025-10-30 15:00:00~2025-10-30 15:00:00), pred=(2025-10-30 15:00:00~2025-10-30 15:00:00)
  [4] TurbID=1, start_idx=2917, hist=(2025-10-30 16:00:00~2025-10-30 16:00:00), pred=(2025-10-30 16:00:00~2025-10-30 16:00:00)
[DEBUG] target_scaler.scale_ : [460.11395043]
[DEBUG] feature_scaler.mean_: [ 7.63311543e+00  7.25987039e+02  1.10326964e-18 -5.63146529e-18
  6.32851307e-04 -1.86239544e-01]
[DEBUG] target_scaler.mean_: [746.06511492]
[DEBUG] exo_scaler.mean_: [ 7.78879236e+00  1.10326964e-18 -5.63146529e-18 -1.45213366e-01
 -1.16613238e-01]
[INFO] Val samples: 5988, Test samples: 6059
[INFO] Saved metrics to: v2/results/metrics_seq2seq.json
[RESULT] val: {'mae': 191.00686645507812, 'rmse': 259.0948034745197, 'mse_scaled': 0.31709293008806233}
[RESULT] test: {'mae': 190.39529418945312, 'rmse': 258.52880037821706, 'mse_scaled': 0.3157091239858606}
[DEBUG] Saved val MAE: 121.216, RMSE: 172.460 (from npy)

[一致性核查]
  保存值  — MAE: 121.216   RMSE: 172.460
  重跑值  — MAE: 191.007   RMSE: 259.095
  差异    — MAE:  69.791   RMSE:  86.635

  前 5 条样本对比（true | saved_pred | recompute_pred | diff）：
    sample-0: true=1376.11  saved=1448.89  recompute=  81.08  diff=1367.81
    sample-1: true=1453.85  saved=1286.22  recompute= 720.66  diff= 565.56
    sample-2: true=1538.67  saved=1422.53  recompute= 334.42  diff=1088.11
    sample-3: true=1442.91  saved=1387.19  recompute= 237.52  diff=1149.67
    sample-4: true=1067.15  saved= 896.75  recompute=  71.12  diff= 825.63
