/root/wind_power_diffusion/v2/src/utils.py:75: UserWarning: Could not infer format, so each element will be parsed individually, falling back to `dateutil`. To ensure parsing is consistent and as-expected, please specify a format.
  df[time_col] = pd.to_datetime(df[time_col], errors="coerce")
Run args: {'data': 'v2/results/cleaned.csv', 'raw': False, 'id_col': None, 'time_col': None, 'wind_col': None, 'power_col': None, 'hist_len': 24, 'pred_len': 24, 'stride': 1, 'time_encode': None, 'emb_dim': 16, 'checkpoint': 'v2/results/checkpoints/seq2seq/best.pth', 'samples': 100, 'out_prefix': 'v2/results/seq2seq', 'shuffle_split': False, 'shuffle_seed': 42, 'seed': 42}
[DEBUG] Loaded 609679 rows from v2/results/cleaned.csv
[DEBUG] hist_len=24, pred_len=24, stride=1
[DEBUG] id_col=TurbID, time_col=Tmstamp, wind_col=Wspd, power_col=Patv
[DEBUG] Using time encoding mode: sin-cos (inferred=sin-cos)
[DEBUG] Data head:
   TurbID  Day             Tmstamp  ...  hour_cos   dow_sin   dow_cos
0       1    1 2025-10-29 00:00:00  ...  1.000000  0.974928 -0.222521
1       1    1 2025-10-29 01:00:00  ...  0.965926  0.974928 -0.222521
2       1    1 2025-10-29 02:00:00  ...  0.866025  0.974928 -0.222521
3       1    1 2025-10-29 03:00:00  ...  0.707107  0.974928 -0.222521
4       1    1 2025-10-29 04:00:00  ...  0.500000  0.974928 -0.222521

[5 rows x 13 columns]
[INFO] Test split samples: 0
[INFO] Test loader batches: 0
Error: No test samples constructed after windowing and split.
请检查 hist_len, pred_len, stride 参数，或数据清洗后是否还有足够的连续数据段。
建议：
1. 检查数据清洗逻辑是否过于严格导致数据量太少。
2. 调整 hist_len, pred_len, stride 参数，保证每个连续段长度大于 hist_len+pred_len。
3. 检查原始数据是否有大量缺失或中断。
