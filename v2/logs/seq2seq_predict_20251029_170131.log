/root/wind_power_diffusion/v2/src/utils.py:75: UserWarning: Could not infer format, so each element will be parsed individually, falling back to `dateutil`. To ensure parsing is consistent and as-expected, please specify a format.
  df[time_col] = pd.to_datetime(df[time_col], errors="coerce")
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/root/wind_power_diffusion/v2/src/predict.py", line 175, in <module>
    main()
  File "/opt/conda/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/wind_power_diffusion/v2/src/predict.py", line 89, in main
    test_ds = WindSeqDataset(indexer.groups, splits.test, feature_cols, target_col, args.hist_len, args.pred_len, exo_cols,
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/wind_power_diffusion/v2/src/dataset.py", line 133, in __init__
    self._prepare_scaled_views()
  File "/root/wind_power_diffusion/v2/src/dataset.py", line 169, in _prepare_scaled_views
    g["_feat_scaled"] = self.feature_scaler.transform(feats)
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/sklearn/utils/_set_output.py", line 316, in wrapped
    data_to_wrap = f(self, X, *args, **kwargs)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/sklearn/preprocessing/_data.py", line 1075, in transform
    X = validate_data(
        ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/sklearn/utils/validation.py", line 2975, in validate_data
    _check_n_features(_estimator, X, reset=reset)
  File "/opt/conda/lib/python3.11/site-packages/sklearn/utils/validation.py", line 2839, in _check_n_features
    raise ValueError(
ValueError: X has 4 features, but StandardScaler is expecting 6 features as input.
Run args: {'data': 'v2/results/cleaned.csv', 'raw': False, 'id_col': None, 'time_col': None, 'wind_col': None, 'power_col': None, 'hist_len': 24, 'pred_len': 24, 'stride': 1, 'time_encode': 'raw', 'emb_dim': 16, 'checkpoint': 'v2/results/checkpoints/seq2seq/best.pth', 'samples': 100, 'out_prefix': 'v2/results/seq2seq', 'shuffle_split': False, 'shuffle_seed': 42, 'seed': 42}
[DEBUG] Loaded 609679 rows from v2/results/cleaned.csv
[DEBUG] hist_len=24, pred_len=24, stride=1
[DEBUG] id_col=TurbID, time_col=Tmstamp, wind_col=Wspd, power_col=Patv
[DEBUG] Data head:
   TurbID  Day             Tmstamp  ...  hour_cos   dow_sin   dow_cos
0       1    1 2025-10-29 00:00:00  ...  1.000000  0.974928 -0.222521
1       1    1 2025-10-29 01:00:00  ...  0.965926  0.974928 -0.222521
2       1    1 2025-10-29 02:00:00  ...  0.866025  0.974928 -0.222521
3       1    1 2025-10-29 03:00:00  ...  0.707107  0.974928 -0.222521
4       1    1 2025-10-29 04:00:00  ...  0.500000  0.974928 -0.222521

[5 rows x 13 columns]
